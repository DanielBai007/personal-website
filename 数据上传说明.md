# 📊 满意度评价分析平台 - 自动数据上传使用说明

## 🚀 项目概述

本项目提供了一个完整的课程满意度评价数据分析解决方案，包含：
- **satisfaction_dashboard**: 原有的满意度分析平台（来自`/Users/mr.bai/工作站/satisfaction_dashboard-2.0`）
- **auto_data_loader.html**: 新增的自动数据加载器
- **public/data**: 包含课程评价数据的目录

## 📁 项目结构

```
个人站/
├── satisfaction_dashboard/          # 满意度分析平台
│   ├── index.html                  # 分析平台主页面
│   ├── js/                         # JavaScript文件
│   │   ├── main.js                # 主功能文件（已增强自动加载）
│   │   └── script.js              # 脚本文件
│   └── css/                        # 样式文件
├── public/data/                     # 数据文件目录
│   ├── 课程评价数据.xlsx           # Excel格式的评价数据
│   └── 课程场次.csv                # CSV格式的场次信息
└── auto_data_loader.html           # 自动数据加载器
```

## 🎯 使用步骤

### 步骤 1: 启动自动数据加载器

```bash
# 在项目根目录，打开自动数据加载器
open auto_data_loader.html
```

或者在浏览器中访问: `file:///Users/mr.bai/个人站/auto_data_loader.html`

### 步骤 2: 预览数据文件

1. 点击 **🔍 预览数据** 按钮
2. 系统会自动读取以下文件：
   - `public/data/课程评价数据.xlsx` - 学生评价数据
   - `public/data/课程场次.csv` - 课程场次和老师信息
3. 查看数据预览，确认数据格式正确

### 步骤 3: 自动加载数据

1. 点击 **📤 自动加载数据** 按钮
2. 系统将自动：
   - 解析Excel和CSV文件
   - 将数据存储到浏览器缓存
   - 创建自动加载标识
   - 跳转到分析平台

### 步骤 4: 查看分析结果

- 系统会自动打开满意度分析平台
- 数据会自动加载并显示分析结果
- 无需手动上传文件

## 📋 数据文件格式要求

### 课程评价数据 (Excel文件)

需要包含以下列：
- `content`: 评价内容（包含星级标签）
- `session_id` 或 `场次ID`: 课程场次标识
- 其他评价相关字段

示例：
```
content                     | session_id | create_time
讲解很透彻★★★★★ 精彩纷呈★★★★★ | 3409190   | 2024-01-01
讲解模糊★★☆☆☆ 平淡无趣★★☆☆☆   | 3409191   | 2024-01-02
```

### 课程场次信息 (CSV文件)

需要包含以下列：
- `场次ID`: 对应评价数据中的session_id
- `主讲老师姓名`: 授课老师名称
- `课程学科`: 课程学科分类
- `课程年级`: 目标年级
- `课程名称`: 课程名称

示例：
```csv
课程ID,课程名称,课程学科,课程年级,场次ID,主讲老师姓名
100001,初一数学,数学,初一,3409190,王老师
100001,初一数学,数学,初一,3409191,张老师
```

## ⚙️ 技术特性

### 🔄 自动数据加载流程

1. **文件读取**: 使用现代Web API读取本地文件
2. **数据解析**: 
   - Excel文件通过XLSX.js库解析
   - CSV文件通过Papa Parse库解析
3. **数据缓存**: 使用localStorage存储解析后的数据
4. **自动同步**: 分析平台启动时自动检测并加载缓存数据

### 🎨 用户体验优化

- **进度指示**: 实时显示数据加载进度
- **状态通知**: 成功/失败状态的可视化反馈
- **数据预览**: 加载前可预览数据内容
- **错误处理**: 完善的错误捕获和用户提示

### 📊 分析平台增强

- **自动标签解析**: 智能识别评价中的星级标签系统
- **占位符过滤**: 自动识别并过滤占位符内容
- **多维度分析**: 支持按老师、学科、年级等维度分析
- **可视化图表**: 丰富的图表展示评价趋势

## 🔧 故障排除

### 常见问题

1. **数据文件不存在**
   - 确认 `public/data/` 目录下有相应文件
   - 检查文件名是否正确（区分大小写）

2. **数据格式错误**
   - 确认Excel文件包含必要的列
   - 检查CSV文件编码（建议使用UTF-8）

3. **浏览器兼容性**
   - 使用现代浏览器（Chrome, Firefox, Safari, Edge）
   - 确保启用了JavaScript

4. **文件访问权限**
   - 在本地服务器环境下运行（避免file://协议限制）
   - 或使用支持本地文件访问的浏览器设置

### 调试信息

- 打开浏览器开发者工具(F12)
- 查看Console标签页的日志信息
- 检查Network标签页的文件加载状态

## 🚀 快速启动

```bash
# 1. 确认数据文件存在
ls -la public/data/

# 2. 启动自动加载器
open auto_data_loader.html

# 3. 或者直接打开分析平台
open satisfaction_dashboard/index.html
```

## 📞 技术支持

如果遇到问题，请检查：
1. 数据文件格式是否符合要求
2. 浏览器控制台是否有错误信息
3. 网络连接是否正常（需要加载外部CDN资源）

---

**更新时间**: 2024年12月
**版本**: v2.1 - 增强自动加载功能 